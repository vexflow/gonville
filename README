User README for Gonville
========================

This directory contains Gonville, a font of musical symbols drawn by
Simon Tatham and usable as a drop-in replacement for GNU Lilypond's
default symbol set.

Installation
------------

Lilypond expects to find its musical symbols fonts in the 'fonts'
subdirectory of its data directory, which is typically in a
version-numbered subdirectory of /usr/share/lilypond.

If you're using Lilypond 2.20 or later, then there's a font-switching
system built into Lilypond itself. To make Gonville available, you
need to copy or symlink all the files from the 'lilyfonts'
subdirectory into Lilypond's data directory. For example (assuming
Lilypond 2.20 is installed in the place where an OS packager would put
it):

  cp -rT lilyfonts /usr/share/lilypond/2.20/fonts

Having done that, you can select Gonville in your .ly source file or
on the Lilypond command line: see the next section.

For earlier versions of Lilypond, up to and including the older 2.18
series and the beginning of 2.19, there is no convenient method for
specifying a different font of musical symbols. So the only way to get
those versions of Lilypond to use Gonville is to _replace_ the
existing font files in the Lilypond data directory. The
'lilyfonts-old' subdirectory of this distribution archive is provided
for that purpose. For example, you might do this:

  cp -rT lilyfonts-old /usr/share/lilypond/2.18/fonts

But after you do that, you can't switch the font back and forth:
when you run using that data directory, you'll always get Gonville.

Selecting Gonville in Lilypond 2.20
-----------------------------------

If you've installed Gonville alongside Lilypond 2.20, then you can
select it in your Lilypond source file using a directive such as this:

  \paper {
    #(define fonts (set-global-fonts #:music "gonville" #:brace "gonville"))
  }

If you'd rather select it on Lilypond's command line (e.g. because you
don't want to modify someone else's score file, or make a dependency
on Gonville in score files you plan to give other people), you can
pre-include the configuration header 'gonville.ily' provided in this
archive, by running a command such as this:

  lilypond -d include-settings=gonville.ily my-input-file.ly

Selecting Gonville in Lilypond 2.18 on Linux
--------------------------------------------

If you're running on Linux, you can get around Lilypond 2.18's lack of
font selection options by _temporarily_ replacing the Lilypond
standard fonts directory, using 'unshare' and a bind mount:

  $ unshare -mr
  # mount --bind lilyfonts-old /usr/share/lilypond/2.18/fonts
  # lilypond my-input-file.ly
  # exit
  $

Then instances of Lilypond run under the modified environment will get
Gonville, but run normally outside 'unshare', they'll use Lilypond's
standard font.

However, this trick only works if your Linux distribution has enabled
the OS capabilities that 'unshare' depends on; not all of them do.

Supported features
------------------

Gonville has been tested against Lilypond 2.18.2 (the version included
in Ubuntu 18.04) and 2.20. It supports all the same symbols as the
standard fonts for those versions of Lilypond, except for the
following omissions:

 - Solfa note head shapes (set using shapeNoteStyles) are not
   supported.

 - The 'longa' note (twice as long as a breve) is not supported.

 - Ancient notation (mensural, Gregorian chant etc) is not
   supported.

Sometimes Lilypond changes the names under which it expect to be able
to find symbols in the font file. I intend to try to keep Gonville up
to date, but please let me know if there are any support problems with
a more recent version of Lilypond.
